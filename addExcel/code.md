```1c
&НаКлиенте
Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	Проводник = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Проводник.Заголовок = "Выберите файл";
	Фильтр = "Файл Excel (*.xls)|*.xls";
	Проводник.Фильтр = Фильтр;
	Оповещение = Новый ОписаниеОповещения("ПослеВыбораФайла", ЭтотОбъект);
	Проводник.Показать(Оповещение);
КонецПроцедуры
&НаКлиенте
Процедура ПослеВыбораФайла(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
	Если ВыбранныеФайлы = Неопределено Тогда 
		Возврат;
	КонецЕсли;
	Объект.ПутьКФайлу = ВыбранныеФайлы[0]
КонецПроцедуры
&НаКлиенте
Процедура ПрочитатьФайл(Команда)
	Объект.ДанныеФайла.Очистить();
	ПрочитатьФайл_XLS();
КонецПроцедуры
&НаСервере
Процедура ПрочитатьФайл_XLS_НаСервере()
	ТабДок = Новый ТабличныйДокумент;
	
	Попытка
		ТабДок.Прочитать(Объект.ПутьКФайлу, СпособЧтенияЗначенийТабличногоДокумента.Значение);
	Исключение
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Не удалось прочитать указанный файл по причине: " + ОписаниеОшибки();
		Сообщение.Сообщить();
		Возврат;
	КонецПопытки;
	
	КоличествоСтрок = ТабДок.ВысотаТаблицы;
	
	Для НомерСтроки = 2 По КоличествоСтрок Цикл 
		СтрокаДанных = Объект.ДанныеФайла.Добавить();
		СтрокаДанных.Наименование = ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 1).ТекущаяОбласть.Текст;
		СтрокаДанных.Кодс = ТабДок.ПолучитьОбласть("R" + Формат(НомерСтроки, "ЧГ=0") + "C" + 2).ТекущаяОбласть.Текст;
    КонецЦикла;
КонецПроцедуры
&НаКлиенте
Процедура ПрочитатьФайл_XLS()
	ПрочитатьФайл_XLS_НаСервере();
КонецПроцедуры
&НаКлиенте
Процедура ЗаписатьДанные(Команда)
	ЗаписатьДанныеНаСервере();
КонецПроцедуры
&НаСервере
Процедура ЗаписатьДанныеНаСервере()	
	МассивНаименование = Новый Массив;
	Для Каждого СтрокаДанных Из Объект.ДанныеФайла Цикл
		МассивНаименование.Добавить(Строка(СтрокаДанных.Наименование));
	КонецЦикла;
	
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	ТестовыйСправочник.Ссылка КАК Ссылка,
		|	ТестовыйСправочник.Наименование КАК Наименование
		|ИЗ
		|	Справочник.ТестовыйСправочник КАК ТестовыйСправочник
		|ГДЕ
		|	ТестовыйСправочник.Наименование В(&МассивНаименование)";
	
	Запрос.УстановитьПараметр("МассивНаименование", МассивНаименование);
	
	РезультатЗапроса = Запрос.Выполнить();		
	Таблица = РезультатЗапроса.Выгрузить();
	
	Для каждого СтрокаДанных Из Объект.ДанныеФайла Цикл
		
		Повторение = Таблица.Найти(Строка(СтрокаДанных.Наименование), "Наименование");
		Если Повторение <> Неопределено Тогда
			Продолжить;
		КонецЕсли;
		
		НоваяЗапись = Справочники.ТестовыйСправочник.СоздатьЭлемент();
		НоваяЗапись.Наименование = СтрокаДанных.Наименование;
		НоваяЗапись.Кодс = СтрокаДанных.Кодс;
		
		НоваяЗапись.Записать();
	КонецЦикла;
	Сообщить("Добавление записей завершено!");
КонецПроцедуры
```
